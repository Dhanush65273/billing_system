{% extends "base.html" %}
{% block title %}Outstanding Report{% endblock %}

{% block content %}
<h2>Outstanding Report</h2>

<div class="btn-outline-group mb-3" role="group">
    <a href="{% url 'payment_report' %}"          class="btn btn-outline-primary">Payments</a>
    <a href="{% url 'customer_report' %}"         class="btn btn-outline-primary">Customer Wise</a>
    <a href="{% url 'product_report' %}"          class="btn btn-outline-primary">Product Wise</a>
    <a href="{% url 'invoice_report' %}"          class="btn btn-outline-primary">Invoice Wise</a>
    <a href="{% url 'monthly_report' %}"          class="btn btn-outline-primary">Monthly Summary</a>

    {# ðŸ”µ CURRENT PAGE = Outstanding #}
    <a href="{% url 'outstanding_report' %}"      class="btn btn-outline-primary">Outstanding</a>

    {# Customer Summary normal outline #}
    <a href="{% url 'customer_summary_report' %}" class="btn btn-outline-primary">Customer Summary</a>
</div>


<table class="table table-striped align-middle">
    <thead>
        <tr>
            <th>S.No</th>
            <th>Invoice #</th>
            <th>Date</th>
            <th>Customer</th>
            <th>Total Amount (â‚¹)</th>
            <th>Paid (â‚¹)</th>
            <th>Outstanding (â‚¹)</th>
            <th>Status</th>
        </tr>
    </thead>
    <tbody>
        {% for row in rows %}
        {% with inv=row.invoice %}
        <tr>
            <td>{{ forloop.counter }}</td>
            <td>Invoice #{{ inv.id }}</td>
            <td>{{ inv.date|date:"d-m-Y" }}</td>
            <td>{{ inv.customer.name }}</td>
            <td>{{ row.total|floatformat:2 }}</td>
            <td>{{ row.paid|floatformat:2 }}</td>
            <td>{{ row.balance|floatformat:2 }}</td>
            <td>
                {% if inv.status == "paid" %}
                    <span class="badge bg-success">PAID</span>
                {% elif inv.status == "partial" %}
                    <span class="badge bg-warning text-dark">PARTIAL</span>
                {% elif inv.status == "unpaid" %}
                    <span class="badge bg-danger">UNPAID</span>
                {% else %}
                    <span class="badge bg-secondary">{{ inv.get_status_display }}</span>
                {% endif %}
            </td>
        </tr>
        {% endwith %}
        {% empty %}
        <tr>
            <td colspan="8" class="text-center">No outstanding invoices.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<a href="{% url 'outstanding_report_csv' %}" class="btn btn-outline-primary">
    Download CSV
</a>
{% endblock %}
