{% extends 'base.html' %}
{% block title %}{{ title }}{% endblock %}

{% block content %}
<h2>{{ title }}</h2>

<form method="post">
  {% csrf_token %}

  <div class="row mb-3">
    <div class="col-md-4">
      <label class="form-label">Customer</label>
      {{ form.customer }}
    </div>
    <div class="col-md-4">
      <label class="form-label">Invoice Date</label>
      {{ form.date }}
    </div>
    <div class="col-md-2">
      <label class="form-label">Tax %</label>
      {{ form.tax_percent }}
    </div>
    <div class="col-md-2">
      <label class="form-label">Discount (₹)</label>
      {{ form.discount_amount }}
    </div>
  </div>

  <div class="row mb-3">
    <div class="col-md-3">
      <label class="form-label">Status</label>
      {{ form.status }}
    </div>
  </div>

  <h5 class="mt-4">Items</h5>

  {{ formset.management_form }}
  <table class="table table-bordered align-middle">
    <thead class="table-light">
      <tr>
        <th style="width:40px;">#</th>
        <th>Product</th>
        <th style="width:120px;">Quantity</th>
        <th style="width:150px;">Unit price (₹)</th>
        <th style="width:80px;">Delete</th>
      </tr>
    </thead>
    <tbody>
      {% for f in formset %}
      <tr>
        <td>{{ forloop.counter }}</td>
        <td>{{ f.product }}</td>
        <td>{{ f.quantity }}</td>
        <td>{{ f.unit_price }}</td>
        <td>
          {% if f.instance.pk %}
            {{ f.DELETE }}
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>

  <button type="submit" class="btn btn-success">Create Invoice</button>
  <a href="{% url 'invoice_list' %}" class="btn btn-secondary">Cancel</a>
</form>{% endblock %}
